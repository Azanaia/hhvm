error: Typing[4110] Invalid argument

 3 | function foo(arraykey... $_): void {}
 4 | 
 5 | function bar(int $x, string $y, bool $z): void{
 6 |   foo($x, $y, »$z«);
 7 | }

File "fn_call_variadic.php", line 6, character 15 - line 6, character 16:

Expected `arraykey` (variadic argument)

 3 | function foo(arraykey... »$_«): void {}
 4 | 
 5 | function bar(int $x, string $y, bool $z): void{
 6 |   foo($x, $y, $z);
 7 | }

File "fn_call_variadic.php", line 3, character 26 - line 3, character 27:

But got `bool`

 3 | function foo(arraykey... $_): void {}
 4 | 
 5 | function bar(int $x, string $y, »bool« $z): void{
 6 |   foo($x, $y, $z);
 7 | }

File "fn_call_variadic.php", line 5, character 33 - line 5, character 36:

Step 1 of 2

I started by checking this subtype relationship.

The subtype comes from this function or method declaration

 3 | function »foo«(arraykey... $_): void {}
 4 | 
 5 | function bar(int $x, string $y, bool $z): void{
 6 |   foo($x, $y, $z);
 7 | }

File "fn_call_variadic.php", line 3, character 10 - line 3, character 12:

The supertype comes from this expression

 3 | function foo(arraykey... $_): void {}
 4 | 
 5 | function bar(int $x, string $y, bool $z): void{
 6 |   »foo($x, $y, $z)«;
 7 | }

File "fn_call_variadic.php", line 6, character 3 - line 6, character 17:

Step 2 of 2

These are function types so next I checked the 3rd function parameter of the supertype and the 1st parameter of the subtype were subtypes (functions are contravariant in their parameters the direction of the subtype relationship is reversed).

This step is the cause of the error.

The subtype comes from this hint

 3 | function foo(arraykey... $_): void {}
 4 | 
 5 | function bar(int $x, string $y, »bool« $z): void{
 6 |   foo($x, $y, $z);
 7 | }

File "fn_call_variadic.php", line 5, character 33 - line 5, character 36:

and flows into this expression as the parameter hint

 3 | function foo(arraykey... $_): void {}
 4 | 
 5 | function bar(int $x, string $y, bool »$z«): void{
 6 |   foo($x, $y, $z);
 7 | }

File "fn_call_variadic.php", line 5, character 38 - line 5, character 39:

which itself flows into this expression as the type of the local variable

 3 | function foo(arraykey... $_): void {}
 4 | 
 5 | function bar(int $x, string $y, bool $z): void{
 6 |   foo($x, $y, »$z«);
 7 | }

File "fn_call_variadic.php", line 6, character 15 - line 6, character 16:

The supertype comes from this variadic parameter declaration

 3 | function foo(arraykey... »$_«): void {}
 4 | 
 5 | function bar(int $x, string $y, bool $z): void{
 6 |   foo($x, $y, $z);
 7 | }

File "fn_call_variadic.php", line 3, character 26 - line 3, character 27:

1 error found.
