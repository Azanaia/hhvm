error: NastCheck[3030] Lacking `__construct`, class `Test` does not initialize its private member(s): `c1`

 8 | abstract class »Test« {
 9 |   private C1 $c1;

File "workplace_non_exact.php", line 8, character 16 - line 8, character 19:

error: Typing[4110] Invalid argument

  8 | abstract class Test {
  9 |   private C1 $c1;
 10 | 
 11 |   public function fInstance(): void {
 12 |     $this->c1->f(»$this->c1«);
 13 |     $c1 = $this->c1;
 14 |     $c1->f($c1);

File "workplace_non_exact.php", line 12, character 18 - line 12, character 26:

Expected `<expr#3> as C1`

 3 | abstract class C1 {
 4 |   public function f(»this« $_): void {
 5 |   }
 6 | }

File "workplace_non_exact.php", line 4, character 21 - line 4, character 24:

  where `<expr#3>` is a reference to this expression

  8 | abstract class Test {
  9 |   private C1 $c1;
 10 | 
 11 |   public function fInstance(): void {
 12 |     »$this->c1«->f($this->c1);
 13 |     $c1 = $this->c1;
 14 |     $c1->f($c1);

File "workplace_non_exact.php", line 12, character 5 - line 12, character 13:

But got `C1`

 8 | abstract class Test {
 9 |   private »C1« $c1;
10 | 
11 |   public function fInstance(): void {
12 |     $this->c1->f($this->c1);
13 |     $c1 = $this->c1;
14 |     $c1->f($c1);

File "workplace_non_exact.php", line 9, character 11 - line 9, character 12:

Step 1 of 2

I started by checking this subtype relationship.

The subtype comes from this function or method declaration

 3 | abstract class C1 {
 4 |   public function »f«(this $_): void {
 5 |   }
 6 | }

File "workplace_non_exact.php", line 4, character 19 - line 4, character 19:

The supertype comes from this expression

  8 | abstract class Test {
  9 |   private C1 $c1;
 10 | 
 11 |   public function fInstance(): void {
 12 |     »$this->c1->f($this->c1)«;
 13 |     $c1 = $this->c1;
 14 |     $c1->f($c1);

File "workplace_non_exact.php", line 12, character 5 - line 12, character 27:

Step 2 of 2

These are function types so next I checked the 1st function parameter of the supertype and subtype were subtypes (functions are contravariant in their parameters so the direction of the subtype relationship is reversed).

This step is the cause of the error.

The subtype comes from this type variable

  8 | abstract class Test {
  9 |   private C1 $c1;
 10 | 
 11 |   public function fInstance(): void {
 12 |     $this->c1->f(»$this->c1«);
 13 |     $c1 = $this->c1;
 14 |     $c1->f($c1);

File "workplace_non_exact.php", line 12, character 18 - line 12, character 26:

which I solved to this hint

 8 | abstract class Test {
 9 |   private »C1« $c1;
10 | 
11 |   public function fInstance(): void {
12 |     $this->c1->f($this->c1);
13 |     $c1 = $this->c1;
14 |     $c1->f($c1);

File "workplace_non_exact.php", line 9, character 11 - line 9, character 12:

which is defined here

 3 | abstract class »C1« {
 4 |   public function f(this $_): void {
 5 |   }
 6 | }

File "workplace_non_exact.php", line 3, character 16 - line 3, character 17:

and flows into this expression as the return hint

  8 | abstract class Test {
  9 |   private C1 $c1;
 10 | 
 11 |   public function fInstance(): void {
 12 |     $this->c1->f(»$this->c1«);
 13 |     $c1 = $this->c1;
 14 |     $c1->f($c1);

File "workplace_non_exact.php", line 12, character 18 - line 12, character 26:

The supertype comes from this hint

 3 | abstract class C1 {
 4 |   public function f(»this« $_): void {
 5 |   }
 6 | }

File "workplace_non_exact.php", line 4, character 21 - line 4, character 24:

Since `C1` is not final

 8 | abstract class Test {
 9 |   private »C1« $c1;
10 | 
11 |   public function fInstance(): void {
12 |     $this->c1->f($this->c1);
13 |     $c1 = $this->c1;
14 |     $c1->f($c1);

File "workplace_non_exact.php", line 9, character 11 - line 9, character 12:

this might not be a `C1`

 8 | abstract class Test {
 9 |   private »C1« $c1;
10 | 
11 |   public function fInstance(): void {
12 |     $this->c1->f($this->c1);
13 |     $c1 = $this->c1;
14 |     $c1->f($c1);

File "workplace_non_exact.php", line 9, character 11 - line 9, character 12:

2 errors found.
