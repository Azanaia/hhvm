error: Typing[4110] Invalid argument

 11 | final class TestServiceWA extends TestServiceBase<int, string> {
 12 |   public function __construct(int $a, string $b, ISender<int, null> $sender) {
 13 |     parent::__construct($a, $b, »$sender«);
 14 |   }
 15 | }

File "workplace_contravariant.php", line 13, character 33 - line 13, character 39:

Expected `null`

 11 | final class TestServiceWA extends TestServiceBase<int, string> {
 12 |   public function __construct(int $a, string $b, ISender<int, »null«> $sender) {
 13 |     parent::__construct($a, $b, $sender);
 14 |   }
 15 | }

File "workplace_contravariant.php", line 12, character 63 - line 12, character 66:

But got `string`

 11 | final class TestServiceWA extends TestServiceBase<int, string> {
 12 |   public function __construct(int $a, »string« $b, ISender<int, null> $sender) {
 13 |     parent::__construct($a, $b, $sender);
 14 |   }
 15 | }

File "workplace_contravariant.php", line 12, character 39 - line 12, character 44:

I checked the subtype constraint in [Main] because it was implied by transitivity from the constraints on the generic parameter `TB` of `TestServiceBase` in [Lower] and [Upper]

Main

[Main] Step 1 of 2

I started by checking this subtype relationship.

The subtype comes from this function or method declaration

 3 | abstract class TestServiceBase<TA, TB> {
 4 |   public function »__construct«(
 5 |     protected TA $a,
 6 |     protected TB $b,
 7 |     ISender<TA, ?TB> $sender,
 8 |   ) {}
 9 | }

File "workplace_contravariant.php", line 4, character 19 - line 4, character 29:

The supertype comes from this expression

 11 | final class TestServiceWA extends TestServiceBase<int, string> {
 12 |   public function __construct(int $a, string $b, ISender<int, null> $sender) {
 13 |     »parent::__construct($a, $b, $sender)«;
 14 |   }
 15 | }

File "workplace_contravariant.php", line 13, character 5 - line 13, character 40:

[Main] Step 2 of 2

These are function types so next I checked the 2nd function parameter of the supertype and subtype were subtypes (functions are contravariant in their parameters so the direction of the subtype relationship is reversed).

This step is the cause of the error.

The subtype comes from this hint

 11 | final class TestServiceWA extends TestServiceBase<int, string> {
 12 |   public function __construct(int $a, »string« $b, ISender<int, null> $sender) {
 13 |     parent::__construct($a, $b, $sender);
 14 |   }
 15 | }

File "workplace_contravariant.php", line 12, character 39 - line 12, character 44:

and flows into this expression as the parameter hint

 11 | final class TestServiceWA extends TestServiceBase<int, string> {
 12 |   public function __construct(int $a, string »$b«, ISender<int, null> $sender) {
 13 |     parent::__construct($a, $b, $sender);
 14 |   }
 15 | }

File "workplace_contravariant.php", line 12, character 46 - line 12, character 47:

which itself flows into this expression as the type of the local variable

 11 | final class TestServiceWA extends TestServiceBase<int, string> {
 12 |   public function __construct(int $a, string $b, ISender<int, null> $sender) {
 13 |     parent::__construct($a, »$b«, $sender);
 14 |   }
 15 | }

File "workplace_contravariant.php", line 13, character 29 - line 13, character 30:

The supertype comes from this hint

 11 | final class TestServiceWA extends TestServiceBase<int, string> {
 12 |   public function __construct(int $a, string $b, ISender<int, »null«> $sender) {
 13 |     parent::__construct($a, $b, $sender);
 14 |   }
 15 | }

File "workplace_contravariant.php", line 12, character 63 - line 12, character 66:

Lower

[Lower] Step 1 of 2

I started by checking this subtype relationship.

The subtype comes from this function or method declaration

 3 | abstract class TestServiceBase<TA, TB> {
 4 |   public function »__construct«(
 5 |     protected TA $a,
 6 |     protected TB $b,
 7 |     ISender<TA, ?TB> $sender,
 8 |   ) {}
 9 | }

File "workplace_contravariant.php", line 4, character 19 - line 4, character 29:

The supertype comes from this expression

 11 | final class TestServiceWA extends TestServiceBase<int, string> {
 12 |   public function __construct(int $a, string $b, ISender<int, null> $sender) {
 13 |     »parent::__construct($a, $b, $sender)«;
 14 |   }
 15 | }

File "workplace_contravariant.php", line 13, character 5 - line 13, character 40:

[Lower] Step 2 of 2

These are function types so next I checked the 2nd function parameter of the supertype and subtype were subtypes (functions are contravariant in their parameters so the direction of the subtype relationship is reversed).

The subtype comes from this hint

 11 | final class TestServiceWA extends TestServiceBase<int, string> {
 12 |   public function __construct(int $a, »string« $b, ISender<int, null> $sender) {
 13 |     parent::__construct($a, $b, $sender);
 14 |   }
 15 | }

File "workplace_contravariant.php", line 12, character 39 - line 12, character 44:

and flows into this expression as the parameter hint

 11 | final class TestServiceWA extends TestServiceBase<int, string> {
 12 |   public function __construct(int $a, string »$b«, ISender<int, null> $sender) {
 13 |     parent::__construct($a, $b, $sender);
 14 |   }
 15 | }

File "workplace_contravariant.php", line 12, character 46 - line 12, character 47:

which itself flows into this expression as the type of the local variable

 11 | final class TestServiceWA extends TestServiceBase<int, string> {
 12 |   public function __construct(int $a, string $b, ISender<int, null> $sender) {
 13 |     parent::__construct($a, »$b«, $sender);
 14 |   }
 15 | }

File "workplace_contravariant.php", line 13, character 29 - line 13, character 30:

The supertype comes from this generic parameter `TB` of `TestServiceBase`

 11 | final class TestServiceWA extends TestServiceBase<int, string> {
 12 |   public function __construct(int $a, string $b, ISender<int, null> $sender) {
 13 |     »parent::__construct($a, $b, $sender)«;
 14 |   }
 15 | }

File "workplace_contravariant.php", line 13, character 5 - line 13, character 40:

Upper

[Upper] Step 1 of 4

I started by checking this subtype relationship.

The subtype comes from this function or method declaration

 3 | abstract class TestServiceBase<TA, TB> {
 4 |   public function »__construct«(
 5 |     protected TA $a,
 6 |     protected TB $b,
 7 |     ISender<TA, ?TB> $sender,
 8 |   ) {}
 9 | }

File "workplace_contravariant.php", line 4, character 19 - line 4, character 29:

The supertype comes from this expression

 11 | final class TestServiceWA extends TestServiceBase<int, string> {
 12 |   public function __construct(int $a, string $b, ISender<int, null> $sender) {
 13 |     »parent::__construct($a, $b, $sender)«;
 14 |   }
 15 | }

File "workplace_contravariant.php", line 13, character 5 - line 13, character 40:

[Upper] Step 2 of 4

These are function types so next I checked the 3rd function parameter of the supertype and subtype were subtypes (functions are contravariant in their parameters so the direction of the subtype relationship is reversed).

The subtype comes from this hint

 11 | final class TestServiceWA extends TestServiceBase<int, string> {
 12 |   public function __construct(int $a, string $b, »ISender<int, null>« $sender) {
 13 |     parent::__construct($a, $b, $sender);
 14 |   }
 15 | }

File "workplace_contravariant.php", line 12, character 50 - line 12, character 67:

which is defined here

 21 | interface »ISender«<-TA, -TB> {}
 22 | 
 23 | final class TestFactory {

File "workplace_contravariant.php", line 21, character 11 - line 21, character 17:

and flows into this expression as the parameter hint

 11 | final class TestServiceWA extends TestServiceBase<int, string> {
 12 |   public function __construct(int $a, string $b, ISender<int, null> »$sender«) {
 13 |     parent::__construct($a, $b, $sender);
 14 |   }
 15 | }

File "workplace_contravariant.php", line 12, character 69 - line 12, character 75:

which itself flows into this expression as the type of the local variable

 11 | final class TestServiceWA extends TestServiceBase<int, string> {
 12 |   public function __construct(int $a, string $b, ISender<int, null> $sender) {
 13 |     parent::__construct($a, $b, »$sender«);
 14 |   }
 15 | }

File "workplace_contravariant.php", line 13, character 33 - line 13, character 39:

The supertype comes from this hint

 3 | abstract class TestServiceBase<TA, TB> {
 4 |   public function __construct(
 5 |     protected TA $a,
 6 |     protected TB $b,
 7 |     »ISender<TA, ?TB>« $sender,
 8 |   ) {}
 9 | }

File "workplace_contravariant.php", line 7, character 5 - line 7, character 20:

[Upper] Step 3 of 4

`\ISender` is a class or interface so next I checked the 2nd type arguments are subtypes.

The subtype comes from this hint

 3 | abstract class TestServiceBase<TA, TB> {
 4 |   public function __construct(
 5 |     protected TA $a,
 6 |     protected TB $b,
 7 |     ISender<TA, »?TB«> $sender,
 8 |   ) {}
 9 | }

File "workplace_contravariant.php", line 7, character 17 - line 7, character 19:

The supertype comes from this hint

 11 | final class TestServiceWA extends TestServiceBase<int, string> {
 12 |   public function __construct(int $a, string $b, ISender<int, »null«> $sender) {
 13 |     parent::__construct($a, $b, $sender);
 14 |   }
 15 | }

File "workplace_contravariant.php", line 12, character 63 - line 12, character 66:

[Upper] Step 4 of 4

The subtype is a nullable type so next I checked the non-null part was a subtype of the supertype.

The subtype comes from this generic parameter `TB` of `TestServiceBase`

 11 | final class TestServiceWA extends TestServiceBase<int, string> {
 12 |   public function __construct(int $a, string $b, ISender<int, null> $sender) {
 13 |     »parent::__construct($a, $b, $sender)«;
 14 |   }
 15 | }

File "workplace_contravariant.php", line 13, character 5 - line 13, character 40:

The supertype is the same as before.

 11 | final class TestServiceWA extends TestServiceBase<int, string> {
 12 |   public function __construct(int $a, string $b, ISender<int, »null«> $sender) {
 13 |     parent::__construct($a, $b, $sender);
 14 |   }
 15 | }

File "workplace_contravariant.php", line 12, character 63 - line 12, character 66:

1 error found.
