error: Typing[4110] Invalid return type

 15 | function getClass<Tu as num>(): classname<bar<Tu>> {
 16 |     return »foo::class«;
 17 | }

File "workplace_invariant.php", line 16, character 12 - line 16, character 21:

Expected `int`

 8 | final class foo implements bar<»int«> {
 9 |   public function get(): int {
10 |     return 1;

File "workplace_invariant.php", line 8, character 32 - line 8, character 34:

But got `num`

 15 | function getClass<Tu as »num«>(): classname<bar<Tu>> {
 16 |     return foo::class;
 17 | }

File "workplace_invariant.php", line 15, character 25 - line 15, character 27:

This error has 8 steps, a maximum depth of 2 and contains 0 reversals.

Here's why: this hint

 15 | function getClass<Tu as »num«>(): classname<bar<Tu>> {
 16 |     return foo::class;
 17 | }

File "workplace_invariant.php", line 15, character 25 - line 15, character 27:

flows into this hint becuase it is the upper bound

 15 | function getClass<Tu as num>(): classname<bar<»Tu«>> {
 16 |     return foo::class;
 17 | }

File "workplace_invariant.php", line 15, character 47 - line 15, character 48:

which itself flows up into this hint as the invariant, 1st type parameter of the this class `\bar`, when typing as covariant

 15 | function getClass<Tu as num>(): classname<»bar<Tu>«> {
 16 |     return foo::class;
 17 | }

File "workplace_invariant.php", line 15, character 43 - line 15, character 49:

which itself flows up into this hint as the covariant, 1st type parameter of the this newtype `\HH\classname`

 15 | function getClass<Tu as num>(): »classname<bar<Tu>>« {
 16 |     return foo::class;
 17 | }

File "workplace_invariant.php", line 15, character 33 - line 15, character 50:

which itself flows into this expression because they are required to be subtypes

 15 | function getClass<Tu as num>(): classname<bar<Tu>> {
 16 |     »return foo::class;«
 17 | }

File "workplace_invariant.php", line 16, character 5 - line 16, character 22:

which itself flows into this thing (`Rclass_class`) because it is a return hint

 8 | final class »foo« implements bar<int> {
 9 |   public function get(): int {
10 |     return 1;

File "workplace_invariant.php", line 8, character 13 - line 8, character 15:

which itself flows down into this thing (`Rinstantiate`) as the covariant, 1st type parameter of the this newtype `\HH\classname`

 8 | final class »foo« implements bar<int> {
 9 |   public function get(): int {
10 |     return 1;

File "workplace_invariant.php", line 8, character 13 - line 8, character 15:

which itself flows into this hint because they are subclass and superclass

 8 | final class foo implements »bar<int>« {
 9 |   public function get(): int {
10 |     return 1;

File "workplace_invariant.php", line 8, character 28 - line 8, character 35:

which itself flows down into this hint as the invariant, 1st type parameter of the this class `\bar`, when typing as covariant

 8 | final class foo implements bar<»int«> {
 9 |   public function get(): int {
10 |     return 1;

File "workplace_invariant.php", line 8, character 32 - line 8, character 34:

Raw:
[
  {
    "Hint":[
      {"filename":"workplace_invariant.php","line":15,"char_start":25,"char_end":27}
    ]
  },
  "Flow_upper_bound",
  {
    "Hint":[
      {"filename":"workplace_invariant.php","line":15,"char_start":47,"char_end":48}
    ]
  },
  "Flow_prj",
  {
    "Prj":[
      {"Symm":[{"Prj_symm_ctor":["Ctor_class","\\bar",0,{"Inv":[{"Co":[]}]}]}]},
      [
        {
          "Def":[
            {"filename":"workplace_invariant.php","line":3,"char_start":11,"char_end":13},
            [
              {
                "Hint":[
                  {"filename":"workplace_invariant.php","line":15,"char_start":43,"char_end":49}
                ]
              }
            ]
          ]
        },
        "Flow_subtype",
        {
          "Rev":[
            [
              {
                "Def":[
                  {"filename":"workplace_invariant.php","line":3,"char_start":11,"char_end":13},
                  [
                    {
                      "Hint":[{"filename":"workplace_invariant.php","line":8,"char_start":28,"char_end":35}]
                    }
                  ]
                ]
              },
              "Flow_extends",
              {
                "Instantiate":[
                  [
                    {
                      "Witness":[
                        {"filename":"workplace_invariant.php","line":16,"char_start":12,"char_end":14}
                      ]
                    }
                  ],
                  "this",
                  [
                    {
                      "Class_class":[
                        {"filename":"workplace_invariant.php","line":8,"char_start":13,"char_end":15},
                        "\\foo"
                      ]
                    }
                  ]
                ]
              },
              "Flow_prj",
              {
                "Prj":[
                  {
                    "Symm":[{"Prj_symm_ctor":["Ctor_newtype","\\HH\\classname",0,{"Dir":[{"Co":[]}]}]}]
                  },
                  [
                    {
                      "Def":[
                        {
                          "filename":"/tmp/6GpMwC2D1t/classname.hhi",
                          "line":19,
                          "char_start":11,
                          "char_end":19
                        },
                        [
                          {
                            "Class_class":[
                              {"filename":"workplace_invariant.php","line":8,"char_start":13,"char_end":15},
                              "\\foo"
                            ]
                          }
                        ]
                      ]
                    },
                    "Flow_return_hint",
                    {
                      "Witness":[{"filename":"workplace_invariant.php","line":16,"char_start":5,"char_end":22}]
                    },
                    "Flow_subtype",
                    {
                      "Def":[
                        {
                          "filename":"/tmp/6GpMwC2D1t/classname.hhi",
                          "line":19,
                          "char_start":11,
                          "char_end":19
                        },
                        [
                          {
                            "Hint":[
                              {"filename":"workplace_invariant.php","line":15,"char_start":33,"char_end":50}
                            ]
                          }
                        ]
                      ]
                    }
                  ]
                ]
              }
            ]
          ]
        }
      ]
    ]
  },
  "Flow_subtype_toplevel",
  {
    "Hint":[{"filename":"workplace_invariant.php","line":8,"char_start":32,"char_end":34}]
  }
]


File "", line 0, character 0 - line 0, character -1:

Normalised:
[
  {
    "Hint":[
      {"filename":"workplace_invariant.php","line":15,"char_start":25,"char_end":27}
    ]
  },
  "Flow_upper_bound",
  {
    "Hint":[
      {"filename":"workplace_invariant.php","line":15,"char_start":47,"char_end":48}
    ]
  },
  "Flow_prj",
  {
    "Prj":[
      {"Symm":[{"Prj_symm_ctor":["Ctor_class","\\bar",0,{"Inv":[{"Co":[]}]}]}]},
      [
        {
          "Def":[
            {"filename":"workplace_invariant.php","line":3,"char_start":11,"char_end":13},
            [
              {
                "Hint":[
                  {"filename":"workplace_invariant.php","line":15,"char_start":43,"char_end":49}
                ]
              }
            ]
          ]
        },
        "Flow_subtype",
        {
          "Prj":[
            {
              "Symm":[{"Prj_symm_ctor":["Ctor_newtype","\\HH\\classname",0,{"Dir":[{"Co":[]}]}]}]
            },
            [
              {
                "Def":[
                  {
                    "filename":"/tmp/6GpMwC2D1t/classname.hhi",
                    "line":19,
                    "char_start":11,
                    "char_end":19
                  },
                  [
                    {
                      "Hint":[
                        {"filename":"workplace_invariant.php","line":15,"char_start":33,"char_end":50}
                      ]
                    }
                  ]
                ]
              },
              "Flow_subtype",
              {
                "Witness":[{"filename":"workplace_invariant.php","line":16,"char_start":5,"char_end":22}]
              },
              "Flow_return_hint",
              {
                "Def":[
                  {
                    "filename":"/tmp/6GpMwC2D1t/classname.hhi",
                    "line":19,
                    "char_start":11,
                    "char_end":19
                  },
                  [
                    {
                      "Class_class":[
                        {"filename":"workplace_invariant.php","line":8,"char_start":13,"char_end":15},
                        "\\foo"
                      ]
                    }
                  ]
                ]
              }
            ]
          ]
        },
        "Flow_prj",
        {
          "Instantiate":[
            [
              {
                "Witness":[
                  {"filename":"workplace_invariant.php","line":16,"char_start":12,"char_end":14}
                ]
              }
            ],
            "this",
            [
              {
                "Class_class":[
                  {"filename":"workplace_invariant.php","line":8,"char_start":13,"char_end":15},
                  "\\foo"
                ]
              }
            ]
          ]
        },
        "Flow_extends",
        {
          "Def":[
            {"filename":"workplace_invariant.php","line":3,"char_start":11,"char_end":13},
            [
              {
                "Hint":[{"filename":"workplace_invariant.php","line":8,"char_start":28,"char_end":35}]
              }
            ]
          ]
        }
      ]
    ]
  },
  "Flow_subtype_toplevel",
  {
    "Hint":[{"filename":"workplace_invariant.php","line":8,"char_start":32,"char_end":34}]
  }
]


File "", line 0, character 0 - line 0, character -1:

Path:
{
  "stats":{"max_depth":2,"length":8,"reversals":0},
  "path_elems":[
    [
      {
        "Hint":[
          {"filename":"workplace_invariant.php","line":15,"char_start":25,"char_end":27}
        ]
      }
    ],
    {"Edge":{"dir":"Fwd","kind":"Flow_upper_bound"}},
    [
      {
        "Hint":[
          {"filename":"workplace_invariant.php","line":15,"char_start":47,"char_end":48}
        ]
      }
    ],
    {
      "Edge":{
        "dir":"Fwd",
        "kind":"Flow_prj",
        "in_to":{"Symm":[{"Prj_symm_ctor":["Ctor_class","\\bar",0,{"Inv":[{"Co":[]}]}]}]}
      }
    },
    [
      {
        "Def":[
          {"filename":"workplace_invariant.php","line":3,"char_start":11,"char_end":13},
          [
            {
              "Hint":[
                {"filename":"workplace_invariant.php","line":15,"char_start":43,"char_end":49}
              ]
            }
          ]
        ]
      }
    ],
    {
      "Edge":{
        "dir":"Fwd",
        "kind":"Flow_subtype",
        "in_to":{
          "Symm":[{"Prj_symm_ctor":["Ctor_newtype","\\HH\\classname",0,{"Dir":[{"Co":[]}]}]}]
        }
      }
    },
    [
      {
        "Def":[
          {
            "filename":"/tmp/6GpMwC2D1t/classname.hhi",
            "line":19,
            "char_start":11,
            "char_end":19
          },
          [
            {
              "Hint":[
                {"filename":"workplace_invariant.php","line":15,"char_start":33,"char_end":50}
              ]
            }
          ]
        ]
      }
    ],
    {"Edge":{"dir":"Fwd","kind":"Flow_subtype"}},
    [
      {
        "Witness":[{"filename":"workplace_invariant.php","line":16,"char_start":5,"char_end":22}]
      }
    ],
    {"Edge":{"dir":"Fwd","kind":"Flow_return_hint"}},
    [
      {
        "Def":[
          {
            "filename":"/tmp/6GpMwC2D1t/classname.hhi",
            "line":19,
            "char_start":11,
            "char_end":19
          },
          [
            {
              "Class_class":[
                {"filename":"workplace_invariant.php","line":8,"char_start":13,"char_end":15},
                "\\foo"
              ]
            }
          ]
        ]
      }
    ],
    {
      "Edge":{
        "dir":"Fwd",
        "kind":"Flow_prj",
        "out_of":{
          "Symm":[{"Prj_symm_ctor":["Ctor_newtype","\\HH\\classname",0,{"Dir":[{"Co":[]}]}]}]
        }
      }
    },
    [
      {
        "Instantiate":[
          [
            {
              "Witness":[
                {"filename":"workplace_invariant.php","line":16,"char_start":12,"char_end":14}
              ]
            }
          ],
          "this",
          [
            {
              "Class_class":[
                {"filename":"workplace_invariant.php","line":8,"char_start":13,"char_end":15},
                "\\foo"
              ]
            }
          ]
        ]
      }
    ],
    {"Edge":{"dir":"Fwd","kind":"Flow_extends"}},
    [
      {
        "Def":[
          {"filename":"workplace_invariant.php","line":3,"char_start":11,"char_end":13},
          [
            {
              "Hint":[{"filename":"workplace_invariant.php","line":8,"char_start":28,"char_end":35}]
            }
          ]
        ]
      }
    ],
    {
      "Edge":{
        "dir":"Fwd",
        "kind":"Flow_subtype_toplevel",
        "out_of":{"Symm":[{"Prj_symm_ctor":["Ctor_class","\\bar",0,{"Inv":[{"Co":[]}]}]}]}
      }
    },
    [
      {
        "Hint":[{"filename":"workplace_invariant.php","line":8,"char_start":32,"char_end":34}]
      }
    ]
  ]
}


File "", line 0, character 0 - line 0, character -1:

error: Typing[4110] Invalid return type

 15 | function getClass<Tu as num>(): classname<bar<Tu>> {
 16 |     return »foo::class«;
 17 | }

File "workplace_invariant.php", line 16, character 12 - line 16, character 21:

Expected `int`

 8 | final class foo implements bar<»int«> {
 9 |   public function get(): int {
10 |     return 1;

File "workplace_invariant.php", line 8, character 32 - line 8, character 34:

But got `Tu as num`

 15 | function getClass<Tu as num>(): classname<bar<»Tu«>> {
 16 |     return foo::class;
 17 | }

File "workplace_invariant.php", line 15, character 47 - line 15, character 48:

This error has 7 steps, a maximum depth of 2 and contains 0 reversals.

Here's why: this hint

 15 | function getClass<Tu as num>(): classname<bar<»Tu«>> {
 16 |     return foo::class;
 17 | }

File "workplace_invariant.php", line 15, character 47 - line 15, character 48:

flows up into this hint as the invariant, 1st type parameter of the this class `\bar`, when typing as covariant

 15 | function getClass<Tu as num>(): classname<»bar<Tu>«> {
 16 |     return foo::class;
 17 | }

File "workplace_invariant.php", line 15, character 43 - line 15, character 49:

which itself flows up into this hint as the covariant, 1st type parameter of the this newtype `\HH\classname`

 15 | function getClass<Tu as num>(): »classname<bar<Tu>>« {
 16 |     return foo::class;
 17 | }

File "workplace_invariant.php", line 15, character 33 - line 15, character 50:

which itself flows into this expression because they are required to be subtypes

 15 | function getClass<Tu as num>(): classname<bar<Tu>> {
 16 |     »return foo::class;«
 17 | }

File "workplace_invariant.php", line 16, character 5 - line 16, character 22:

which itself flows into this thing (`Rclass_class`) because it is a return hint

 8 | final class »foo« implements bar<int> {
 9 |   public function get(): int {
10 |     return 1;

File "workplace_invariant.php", line 8, character 13 - line 8, character 15:

which itself flows down into this thing (`Rinstantiate`) as the covariant, 1st type parameter of the this newtype `\HH\classname`

 8 | final class »foo« implements bar<int> {
 9 |   public function get(): int {
10 |     return 1;

File "workplace_invariant.php", line 8, character 13 - line 8, character 15:

which itself flows into this hint because they are subclass and superclass

 8 | final class foo implements »bar<int>« {
 9 |   public function get(): int {
10 |     return 1;

File "workplace_invariant.php", line 8, character 28 - line 8, character 35:

which itself flows down into this hint as the invariant, 1st type parameter of the this class `\bar`, when typing as covariant

 8 | final class foo implements bar<»int«> {
 9 |   public function get(): int {
10 |     return 1;

File "workplace_invariant.php", line 8, character 32 - line 8, character 34:

Raw:
[
  {
    "Hint":[
      {"filename":"workplace_invariant.php","line":15,"char_start":47,"char_end":48}
    ]
  },
  "Flow_prj",
  {
    "Prj":[
      {"Symm":[{"Prj_symm_ctor":["Ctor_class","\\bar",0,{"Inv":[{"Co":[]}]}]}]},
      [
        {
          "Def":[
            {"filename":"workplace_invariant.php","line":3,"char_start":11,"char_end":13},
            [
              {
                "Hint":[
                  {"filename":"workplace_invariant.php","line":15,"char_start":43,"char_end":49}
                ]
              }
            ]
          ]
        },
        "Flow_subtype",
        {
          "Rev":[
            [
              {
                "Def":[
                  {"filename":"workplace_invariant.php","line":3,"char_start":11,"char_end":13},
                  [
                    {
                      "Hint":[{"filename":"workplace_invariant.php","line":8,"char_start":28,"char_end":35}]
                    }
                  ]
                ]
              },
              "Flow_extends",
              {
                "Instantiate":[
                  [
                    {
                      "Witness":[
                        {"filename":"workplace_invariant.php","line":16,"char_start":12,"char_end":14}
                      ]
                    }
                  ],
                  "this",
                  [
                    {
                      "Class_class":[
                        {"filename":"workplace_invariant.php","line":8,"char_start":13,"char_end":15},
                        "\\foo"
                      ]
                    }
                  ]
                ]
              },
              "Flow_prj",
              {
                "Prj":[
                  {
                    "Symm":[{"Prj_symm_ctor":["Ctor_newtype","\\HH\\classname",0,{"Dir":[{"Co":[]}]}]}]
                  },
                  [
                    {
                      "Def":[
                        {
                          "filename":"/tmp/6GpMwC2D1t/classname.hhi",
                          "line":19,
                          "char_start":11,
                          "char_end":19
                        },
                        [
                          {
                            "Class_class":[
                              {"filename":"workplace_invariant.php","line":8,"char_start":13,"char_end":15},
                              "\\foo"
                            ]
                          }
                        ]
                      ]
                    },
                    "Flow_return_hint",
                    {
                      "Witness":[{"filename":"workplace_invariant.php","line":16,"char_start":5,"char_end":22}]
                    },
                    "Flow_subtype",
                    {
                      "Def":[
                        {
                          "filename":"/tmp/6GpMwC2D1t/classname.hhi",
                          "line":19,
                          "char_start":11,
                          "char_end":19
                        },
                        [
                          {
                            "Hint":[
                              {"filename":"workplace_invariant.php","line":15,"char_start":33,"char_end":50}
                            ]
                          }
                        ]
                      ]
                    }
                  ]
                ]
              }
            ]
          ]
        }
      ]
    ]
  },
  "Flow_subtype_toplevel",
  {
    "Hint":[{"filename":"workplace_invariant.php","line":8,"char_start":32,"char_end":34}]
  }
]


File "", line 0, character 0 - line 0, character -1:

Normalised:
[
  {
    "Hint":[
      {"filename":"workplace_invariant.php","line":15,"char_start":47,"char_end":48}
    ]
  },
  "Flow_prj",
  {
    "Prj":[
      {"Symm":[{"Prj_symm_ctor":["Ctor_class","\\bar",0,{"Inv":[{"Co":[]}]}]}]},
      [
        {
          "Def":[
            {"filename":"workplace_invariant.php","line":3,"char_start":11,"char_end":13},
            [
              {
                "Hint":[
                  {"filename":"workplace_invariant.php","line":15,"char_start":43,"char_end":49}
                ]
              }
            ]
          ]
        },
        "Flow_subtype",
        {
          "Prj":[
            {
              "Symm":[{"Prj_symm_ctor":["Ctor_newtype","\\HH\\classname",0,{"Dir":[{"Co":[]}]}]}]
            },
            [
              {
                "Def":[
                  {
                    "filename":"/tmp/6GpMwC2D1t/classname.hhi",
                    "line":19,
                    "char_start":11,
                    "char_end":19
                  },
                  [
                    {
                      "Hint":[
                        {"filename":"workplace_invariant.php","line":15,"char_start":33,"char_end":50}
                      ]
                    }
                  ]
                ]
              },
              "Flow_subtype",
              {
                "Witness":[{"filename":"workplace_invariant.php","line":16,"char_start":5,"char_end":22}]
              },
              "Flow_return_hint",
              {
                "Def":[
                  {
                    "filename":"/tmp/6GpMwC2D1t/classname.hhi",
                    "line":19,
                    "char_start":11,
                    "char_end":19
                  },
                  [
                    {
                      "Class_class":[
                        {"filename":"workplace_invariant.php","line":8,"char_start":13,"char_end":15},
                        "\\foo"
                      ]
                    }
                  ]
                ]
              }
            ]
          ]
        },
        "Flow_prj",
        {
          "Instantiate":[
            [
              {
                "Witness":[
                  {"filename":"workplace_invariant.php","line":16,"char_start":12,"char_end":14}
                ]
              }
            ],
            "this",
            [
              {
                "Class_class":[
                  {"filename":"workplace_invariant.php","line":8,"char_start":13,"char_end":15},
                  "\\foo"
                ]
              }
            ]
          ]
        },
        "Flow_extends",
        {
          "Def":[
            {"filename":"workplace_invariant.php","line":3,"char_start":11,"char_end":13},
            [
              {
                "Hint":[{"filename":"workplace_invariant.php","line":8,"char_start":28,"char_end":35}]
              }
            ]
          ]
        }
      ]
    ]
  },
  "Flow_subtype_toplevel",
  {
    "Hint":[{"filename":"workplace_invariant.php","line":8,"char_start":32,"char_end":34}]
  }
]


File "", line 0, character 0 - line 0, character -1:

Path:
{
  "stats":{"max_depth":2,"length":7,"reversals":0},
  "path_elems":[
    [
      {
        "Hint":[
          {"filename":"workplace_invariant.php","line":15,"char_start":47,"char_end":48}
        ]
      }
    ],
    {
      "Edge":{
        "dir":"Fwd",
        "kind":"Flow_prj",
        "in_to":{"Symm":[{"Prj_symm_ctor":["Ctor_class","\\bar",0,{"Inv":[{"Co":[]}]}]}]}
      }
    },
    [
      {
        "Def":[
          {"filename":"workplace_invariant.php","line":3,"char_start":11,"char_end":13},
          [
            {
              "Hint":[
                {"filename":"workplace_invariant.php","line":15,"char_start":43,"char_end":49}
              ]
            }
          ]
        ]
      }
    ],
    {
      "Edge":{
        "dir":"Fwd",
        "kind":"Flow_subtype",
        "in_to":{
          "Symm":[{"Prj_symm_ctor":["Ctor_newtype","\\HH\\classname",0,{"Dir":[{"Co":[]}]}]}]
        }
      }
    },
    [
      {
        "Def":[
          {
            "filename":"/tmp/6GpMwC2D1t/classname.hhi",
            "line":19,
            "char_start":11,
            "char_end":19
          },
          [
            {
              "Hint":[
                {"filename":"workplace_invariant.php","line":15,"char_start":33,"char_end":50}
              ]
            }
          ]
        ]
      }
    ],
    {"Edge":{"dir":"Fwd","kind":"Flow_subtype"}},
    [
      {
        "Witness":[{"filename":"workplace_invariant.php","line":16,"char_start":5,"char_end":22}]
      }
    ],
    {"Edge":{"dir":"Fwd","kind":"Flow_return_hint"}},
    [
      {
        "Def":[
          {
            "filename":"/tmp/6GpMwC2D1t/classname.hhi",
            "line":19,
            "char_start":11,
            "char_end":19
          },
          [
            {
              "Class_class":[
                {"filename":"workplace_invariant.php","line":8,"char_start":13,"char_end":15},
                "\\foo"
              ]
            }
          ]
        ]
      }
    ],
    {
      "Edge":{
        "dir":"Fwd",
        "kind":"Flow_prj",
        "out_of":{
          "Symm":[{"Prj_symm_ctor":["Ctor_newtype","\\HH\\classname",0,{"Dir":[{"Co":[]}]}]}]
        }
      }
    },
    [
      {
        "Instantiate":[
          [
            {
              "Witness":[
                {"filename":"workplace_invariant.php","line":16,"char_start":12,"char_end":14}
              ]
            }
          ],
          "this",
          [
            {
              "Class_class":[
                {"filename":"workplace_invariant.php","line":8,"char_start":13,"char_end":15},
                "\\foo"
              ]
            }
          ]
        ]
      }
    ],
    {"Edge":{"dir":"Fwd","kind":"Flow_extends"}},
    [
      {
        "Def":[
          {"filename":"workplace_invariant.php","line":3,"char_start":11,"char_end":13},
          [
            {
              "Hint":[{"filename":"workplace_invariant.php","line":8,"char_start":28,"char_end":35}]
            }
          ]
        ]
      }
    ],
    {
      "Edge":{
        "dir":"Fwd",
        "kind":"Flow_subtype_toplevel",
        "out_of":{"Symm":[{"Prj_symm_ctor":["Ctor_class","\\bar",0,{"Inv":[{"Co":[]}]}]}]}
      }
    },
    [
      {
        "Hint":[{"filename":"workplace_invariant.php","line":8,"char_start":32,"char_end":34}]
      }
    ]
  ]
}


File "", line 0, character 0 - line 0, character -1:

error: Typing[4110] Invalid return type

 15 | function getClass<Tu as num>(): classname<bar<Tu>> {
 16 |     return »foo::class«;
 17 | }

File "workplace_invariant.php", line 16, character 12 - line 16, character 21:

Expected `Tu`

 15 | function getClass<Tu as num>(): classname<bar<»Tu«>> {
 16 |     return foo::class;
 17 | }

File "workplace_invariant.php", line 15, character 47 - line 15, character 48:

But got `int`

 8 | final class foo implements bar<»int«> {
 9 |   public function get(): int {
10 |     return 1;

File "workplace_invariant.php", line 8, character 32 - line 8, character 34:

This error has 7 steps, a maximum depth of 2 and contains 0 reversals.

Here's why: this hint

 8 | final class foo implements bar<»int«> {
 9 |   public function get(): int {
10 |     return 1;

File "workplace_invariant.php", line 8, character 32 - line 8, character 34:

flows up into this hint as the invariant, 1st type parameter of the this class `\bar`, when typing as covariant

 8 | final class foo implements »bar<int>« {
 9 |   public function get(): int {
10 |     return 1;

File "workplace_invariant.php", line 8, character 28 - line 8, character 35:

which itself flows into this thing (`Rinstantiate`) because they are subclass and superclass

 8 | final class »foo« implements bar<int> {
 9 |   public function get(): int {
10 |     return 1;

File "workplace_invariant.php", line 8, character 13 - line 8, character 15:

which itself flows up into this thing (`Rclass_class`) as the covariant, 1st type parameter of the this newtype `\HH\classname`

 8 | final class »foo« implements bar<int> {
 9 |   public function get(): int {
10 |     return 1;

File "workplace_invariant.php", line 8, character 13 - line 8, character 15:

which itself flows into this expression because it is a return hint

 15 | function getClass<Tu as num>(): classname<bar<Tu>> {
 16 |     »return foo::class;«
 17 | }

File "workplace_invariant.php", line 16, character 5 - line 16, character 22:

which itself flows into this hint because they are required to be subtypes

 15 | function getClass<Tu as num>(): »classname<bar<Tu>>« {
 16 |     return foo::class;
 17 | }

File "workplace_invariant.php", line 15, character 33 - line 15, character 50:

which itself flows down into this hint as the covariant, 1st type parameter of the this newtype `\HH\classname`

 15 | function getClass<Tu as num>(): classname<»bar<Tu>«> {
 16 |     return foo::class;
 17 | }

File "workplace_invariant.php", line 15, character 43 - line 15, character 49:

which itself flows down into this hint as the invariant, 1st type parameter of the this class `\bar`, when typing as covariant

 15 | function getClass<Tu as num>(): classname<bar<»Tu«>> {
 16 |     return foo::class;
 17 | }

File "workplace_invariant.php", line 15, character 47 - line 15, character 48:

Raw:
[
  {
    "Hint":[{"filename":"workplace_invariant.php","line":8,"char_start":32,"char_end":34}]
  },
  "Flow_prj",
  {
    "Prj":[
      {"Symm":[{"Prj_symm_ctor":["Ctor_class","\\bar",0,{"Inv":[{"Co":[]}]}]}]},
      [
        {
          "Def":[
            {"filename":"workplace_invariant.php","line":3,"char_start":11,"char_end":13},
            [
              {
                "Hint":[{"filename":"workplace_invariant.php","line":8,"char_start":28,"char_end":35}]
              }
            ]
          ]
        },
        "Flow_extends",
        {
          "Instantiate":[
            [
              {
                "Witness":[
                  {"filename":"workplace_invariant.php","line":16,"char_start":12,"char_end":14}
                ]
              }
            ],
            "this",
            [
              {
                "Class_class":[
                  {"filename":"workplace_invariant.php","line":8,"char_start":13,"char_end":15},
                  "\\foo"
                ]
              }
            ]
          ]
        },
        "Flow_prj",
        {
          "Prj":[
            {
              "Symm":[{"Prj_symm_ctor":["Ctor_newtype","\\HH\\classname",0,{"Dir":[{"Co":[]}]}]}]
            },
            [
              {
                "Def":[
                  {
                    "filename":"/tmp/6GpMwC2D1t/classname.hhi",
                    "line":19,
                    "char_start":11,
                    "char_end":19
                  },
                  [
                    {
                      "Class_class":[
                        {"filename":"workplace_invariant.php","line":8,"char_start":13,"char_end":15},
                        "\\foo"
                      ]
                    }
                  ]
                ]
              },
              "Flow_return_hint",
              {
                "Witness":[{"filename":"workplace_invariant.php","line":16,"char_start":5,"char_end":22}]
              },
              "Flow_subtype",
              {
                "Def":[
                  {
                    "filename":"/tmp/6GpMwC2D1t/classname.hhi",
                    "line":19,
                    "char_start":11,
                    "char_end":19
                  },
                  [
                    {
                      "Hint":[
                        {"filename":"workplace_invariant.php","line":15,"char_start":33,"char_end":50}
                      ]
                    }
                  ]
                ]
              }
            ]
          ]
        },
        "Flow_subtype",
        {
          "Def":[
            {"filename":"workplace_invariant.php","line":3,"char_start":11,"char_end":13},
            [
              {
                "Hint":[
                  {"filename":"workplace_invariant.php","line":15,"char_start":43,"char_end":49}
                ]
              }
            ]
          ]
        }
      ]
    ]
  },
  "Flow_subtype_toplevel",
  {
    "Hint":[
      {"filename":"workplace_invariant.php","line":15,"char_start":47,"char_end":48}
    ]
  }
]


File "", line 0, character 0 - line 0, character -1:

Normalised:
[
  {
    "Hint":[{"filename":"workplace_invariant.php","line":8,"char_start":32,"char_end":34}]
  },
  "Flow_prj",
  {
    "Prj":[
      {"Symm":[{"Prj_symm_ctor":["Ctor_class","\\bar",0,{"Inv":[{"Co":[]}]}]}]},
      [
        {
          "Def":[
            {"filename":"workplace_invariant.php","line":3,"char_start":11,"char_end":13},
            [
              {
                "Hint":[{"filename":"workplace_invariant.php","line":8,"char_start":28,"char_end":35}]
              }
            ]
          ]
        },
        "Flow_extends",
        {
          "Instantiate":[
            [
              {
                "Witness":[
                  {"filename":"workplace_invariant.php","line":16,"char_start":12,"char_end":14}
                ]
              }
            ],
            "this",
            [
              {
                "Class_class":[
                  {"filename":"workplace_invariant.php","line":8,"char_start":13,"char_end":15},
                  "\\foo"
                ]
              }
            ]
          ]
        },
        "Flow_prj",
        {
          "Prj":[
            {
              "Symm":[{"Prj_symm_ctor":["Ctor_newtype","\\HH\\classname",0,{"Dir":[{"Co":[]}]}]}]
            },
            [
              {
                "Def":[
                  {
                    "filename":"/tmp/6GpMwC2D1t/classname.hhi",
                    "line":19,
                    "char_start":11,
                    "char_end":19
                  },
                  [
                    {
                      "Class_class":[
                        {"filename":"workplace_invariant.php","line":8,"char_start":13,"char_end":15},
                        "\\foo"
                      ]
                    }
                  ]
                ]
              },
              "Flow_return_hint",
              {
                "Witness":[{"filename":"workplace_invariant.php","line":16,"char_start":5,"char_end":22}]
              },
              "Flow_subtype",
              {
                "Def":[
                  {
                    "filename":"/tmp/6GpMwC2D1t/classname.hhi",
                    "line":19,
                    "char_start":11,
                    "char_end":19
                  },
                  [
                    {
                      "Hint":[
                        {"filename":"workplace_invariant.php","line":15,"char_start":33,"char_end":50}
                      ]
                    }
                  ]
                ]
              }
            ]
          ]
        },
        "Flow_subtype",
        {
          "Def":[
            {"filename":"workplace_invariant.php","line":3,"char_start":11,"char_end":13},
            [
              {
                "Hint":[
                  {"filename":"workplace_invariant.php","line":15,"char_start":43,"char_end":49}
                ]
              }
            ]
          ]
        }
      ]
    ]
  },
  "Flow_subtype_toplevel",
  {
    "Hint":[
      {"filename":"workplace_invariant.php","line":15,"char_start":47,"char_end":48}
    ]
  }
]


File "", line 0, character 0 - line 0, character -1:

Path:
{
  "stats":{"max_depth":2,"length":7,"reversals":0},
  "path_elems":[
    [
      {
        "Hint":[{"filename":"workplace_invariant.php","line":8,"char_start":32,"char_end":34}]
      }
    ],
    {
      "Edge":{
        "dir":"Fwd",
        "kind":"Flow_prj",
        "in_to":{"Symm":[{"Prj_symm_ctor":["Ctor_class","\\bar",0,{"Inv":[{"Co":[]}]}]}]}
      }
    },
    [
      {
        "Def":[
          {"filename":"workplace_invariant.php","line":3,"char_start":11,"char_end":13},
          [
            {
              "Hint":[{"filename":"workplace_invariant.php","line":8,"char_start":28,"char_end":35}]
            }
          ]
        ]
      }
    ],
    {"Edge":{"dir":"Fwd","kind":"Flow_extends"}},
    [
      {
        "Instantiate":[
          [
            {
              "Witness":[
                {"filename":"workplace_invariant.php","line":16,"char_start":12,"char_end":14}
              ]
            }
          ],
          "this",
          [
            {
              "Class_class":[
                {"filename":"workplace_invariant.php","line":8,"char_start":13,"char_end":15},
                "\\foo"
              ]
            }
          ]
        ]
      }
    ],
    {
      "Edge":{
        "dir":"Fwd",
        "kind":"Flow_prj",
        "in_to":{
          "Symm":[{"Prj_symm_ctor":["Ctor_newtype","\\HH\\classname",0,{"Dir":[{"Co":[]}]}]}]
        }
      }
    },
    [
      {
        "Def":[
          {
            "filename":"/tmp/6GpMwC2D1t/classname.hhi",
            "line":19,
            "char_start":11,
            "char_end":19
          },
          [
            {
              "Class_class":[
                {"filename":"workplace_invariant.php","line":8,"char_start":13,"char_end":15},
                "\\foo"
              ]
            }
          ]
        ]
      }
    ],
    {"Edge":{"dir":"Fwd","kind":"Flow_return_hint"}},
    [
      {
        "Witness":[{"filename":"workplace_invariant.php","line":16,"char_start":5,"char_end":22}]
      }
    ],
    {"Edge":{"dir":"Fwd","kind":"Flow_subtype"}},
    [
      {
        "Def":[
          {
            "filename":"/tmp/6GpMwC2D1t/classname.hhi",
            "line":19,
            "char_start":11,
            "char_end":19
          },
          [
            {
              "Hint":[
                {"filename":"workplace_invariant.php","line":15,"char_start":33,"char_end":50}
              ]
            }
          ]
        ]
      }
    ],
    {
      "Edge":{
        "dir":"Fwd",
        "kind":"Flow_subtype",
        "out_of":{
          "Symm":[{"Prj_symm_ctor":["Ctor_newtype","\\HH\\classname",0,{"Dir":[{"Co":[]}]}]}]
        }
      }
    },
    [
      {
        "Def":[
          {"filename":"workplace_invariant.php","line":3,"char_start":11,"char_end":13},
          [
            {
              "Hint":[
                {"filename":"workplace_invariant.php","line":15,"char_start":43,"char_end":49}
              ]
            }
          ]
        ]
      }
    ],
    {
      "Edge":{
        "dir":"Fwd",
        "kind":"Flow_subtype_toplevel",
        "out_of":{"Symm":[{"Prj_symm_ctor":["Ctor_class","\\bar",0,{"Inv":[{"Co":[]}]}]}]}
      }
    },
    [
      {
        "Hint":[
          {"filename":"workplace_invariant.php","line":15,"char_start":47,"char_end":48}
        ]
      }
    ]
  ]
}


File "", line 0, character 0 - line 0, character -1:

3 errors found.
