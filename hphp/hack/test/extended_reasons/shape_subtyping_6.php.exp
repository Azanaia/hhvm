error: Typing[4163] Invalid argument

 11 | function passes_optional_a_at_bool_alias(
 12 |   optional_a_at_bool $s,
 13 | ): void {
 14 |   expects_required_a_at_int_alias(»$s«);
 15 | }

File "shape_subtyping_6.php", line 14, character 35 - line 14, character 36:

The field `a` is **optional**

 11 | function passes_optional_a_at_bool_alias(
 12 |   »optional_a_at_bool« $s,
 13 | ): void {
 14 |   expects_required_a_at_int_alias($s);
 15 | }

File "shape_subtyping_6.php", line 12, character 3 - line 12, character 20:

The field `a` is defined as **required**

 3 | type required_a_at_int = shape('a' => int);
 4 | type optional_a_at_bool = shape(?'a' => bool);
 5 | 
 6 | function expects_required_a_at_int_alias(
 7 |   »required_a_at_int« $s,
 8 | ): void {
 9 | }

File "shape_subtyping_6.php", line 7, character 3 - line 7, character 19:

`a` is defined here

 3 | type required_a_at_int = shape('a' => »int«);
 4 | type optional_a_at_bool = shape(?'a' => bool);

File "shape_subtyping_6.php", line 3, character 39 - line 3, character 41:

Step 1 of 3

I started by checking this subtype relationship.

The subtype comes from this function or method declaration

 3 | type required_a_at_int = shape('a' => int);
 4 | type optional_a_at_bool = shape(?'a' => bool);
 5 | 
 6 | function »expects_required_a_at_int_alias«(
 7 |   required_a_at_int $s,
 8 | ): void {
 9 | }

File "shape_subtyping_6.php", line 6, character 10 - line 6, character 40:

The supertype comes from this expression

 11 | function passes_optional_a_at_bool_alias(
 12 |   optional_a_at_bool $s,
 13 | ): void {
 14 |   »expects_required_a_at_int_alias($s)«;
 15 | }

File "shape_subtyping_6.php", line 14, character 3 - line 14, character 37:

Step 2 of 3

These are function types so next I checked the 1st function parameter of the supertype and subtype were subtypes (functions are contravariant in their parameters so the direction of the subtype relationship is reversed).

The subtype comes from this hint

 11 | function passes_optional_a_at_bool_alias(
 12 |   »optional_a_at_bool« $s,
 13 | ): void {
 14 |   expects_required_a_at_int_alias($s);
 15 | }

File "shape_subtyping_6.php", line 12, character 3 - line 12, character 20:

which is defined here

 3 | type required_a_at_int = shape('a' => int);
 4 | type »optional_a_at_bool« = shape(?'a' => bool);
 5 | 
 6 | function expects_required_a_at_int_alias(
 7 |   required_a_at_int $s,
 8 | ): void {
 9 | }

File "shape_subtyping_6.php", line 4, character 6 - line 4, character 23:

and flows into this expression as the parameter hint

 11 | function passes_optional_a_at_bool_alias(
 12 |   optional_a_at_bool »$s«,
 13 | ): void {
 14 |   expects_required_a_at_int_alias($s);
 15 | }

File "shape_subtyping_6.php", line 12, character 22 - line 12, character 23:

which itself flows into this expression as the type of the local variable

 11 | function passes_optional_a_at_bool_alias(
 12 |   optional_a_at_bool $s,
 13 | ): void {
 14 |   expects_required_a_at_int_alias(»$s«);
 15 | }

File "shape_subtyping_6.php", line 14, character 35 - line 14, character 36:

The supertype comes from this hint

 3 | type required_a_at_int = shape('a' => int);
 4 | type optional_a_at_bool = shape(?'a' => bool);
 5 | 
 6 | function expects_required_a_at_int_alias(
 7 |   »required_a_at_int« $s,
 8 | ): void {
 9 | }

File "shape_subtyping_6.php", line 7, character 3 - line 7, character 19:

which is defined here

 3 | type »required_a_at_int« = shape('a' => int);
 4 | type optional_a_at_bool = shape(?'a' => bool);

File "shape_subtyping_6.php", line 3, character 6 - line 3, character 22:

Step 3 of 3

These are shape types so next I checked the `a` fields were subtypes. The field was optional in the subtype and required in the supertype.

This step is the cause of the error.

The subtype comes from this hint

 3 | type required_a_at_int = shape('a' => int);
 4 | type optional_a_at_bool = shape(?'a' => »bool«);
 5 | 
 6 | function expects_required_a_at_int_alias(
 7 |   required_a_at_int $s,
 8 | ): void {
 9 | }

File "shape_subtyping_6.php", line 4, character 41 - line 4, character 44:

The supertype comes from this hint

 3 | type required_a_at_int = shape('a' => »int«);
 4 | type optional_a_at_bool = shape(?'a' => bool);

File "shape_subtyping_6.php", line 3, character 39 - line 3, character 41:

1 error found.
